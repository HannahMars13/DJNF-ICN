total_gallons <- sum(oil_loss$net_loss) * 42
cat(total_gallons, "gallons of crude oil and gas well liquids have been lost since 2009!")
#Net loss of all products by year
loss_per_year <- oil_loss %>%
group_by(master_year) %>%
summarize(net_loss = sum(net_loss, na.rm=TRUE))
loss_per_year %>%
gt() %>%
cols_label(master_year = "Year",
net_loss = "Net Loss (bbl)") %>%
tab_header(title = "Net of Fracking Products Lost Per Year") %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_title(groups = "title")) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_column_labels())
View(loss_per_year)
View(recovered_per_year)
#Net loss vs recovered barrels graph
lost_and_recovered <- merge(loss_per_year, recovered_per_year)
ggplot(lost_and_recovered, aes(x = master_year)) +
scale_color_manual(values = c("Net Loss" = "red", "Recovered" = "#028A0F")) +
geom_line(aes(y = net_loss, color = "Net Loss")) +
geom_line(aes(y = total_recovered, color = "Recovered")) +
labs(title="Comparing the number of net lost and total recovered barrels of fracking \nproducts between 2009 and 2023",
x="Year", y="Total barrels", color = "Legend") +
theme_minimal()
#Calculating amount of oil recovered in 2023
recovered_2023 <- oil_loss %>%
filter(master_year==2023) %>%
summarize(total_lost = sum(gross_loss, na.rm=TRUE), total_recovered = sum(recovered, na.rm=TRUE), pct_recovered = round((total_recovered/total_lost)*100, 2))
cat(recovered_2023$total_recovered, "barrels were recovered in 2023, which is only", recovered_2023$pct_recovered, "% of the amount of oil that was originally lost.")
#Creating a new column to calculate what percent of the losses typically gets recovered
pct_recovered <- oil_loss %>%
select(master_year, operator_number, county, type_liquid, gross_loss, recovered, net_loss) %>%
mutate(pct_recovered = (recovered/gross_loss)*100) %>%
summarize(avg_pct = round(mean(pct_recovered, na.rm = TRUE), 2))
cat("On average, only", pct_recovered$avg_pct, "% of the lost fracking products are recovered.")
#Total number of incidents across all years
companies <- oil_loss %>%
group_by(operator_number) %>%
count() %>%
arrange(desc(n))
head(companies)
#Totals by year and company
companies_years <- oil_loss %>%
group_by(operator_number, master_year) %>%
count() %>%
arrange(desc(n))
head(companies_years)
#Net loss per company
net_loss <- oil_loss %>%
select(operator_number, net_loss) %>%
group_by(operator_number) %>%
summarize(net_barrels = sum(net_loss, na.rm=TRUE)) %>%
arrange(desc(net_barrels))
head(net_loss)
#Finding the average amount of barrels lost per company
oil_loss %>%
select(operator_number, net_loss) %>%
group_by(operator_number) %>%
summarize(avg_barrels = mean(net_loss, na.rm=TRUE)) %>%
arrange(desc(avg_barrels))
head(companies)
companies %>%
gt() %>%
cols_label(operator_number = "Company",
net_loss = "Total Incidents") %>%
tab_header(title = "Total Reported Oil Loss Incidents Per Company") %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_title(groups = "title")) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_column_labels()) %>%
slice_head(n=10)
View(companies)
companies %>%
gt() %>%
cols_label(operator_number = "Company",
n = "Total Incidents") %>%
tab_header(title = "Total Reported Oil Loss Incidents Per Company") %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_title(groups = "title")) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_column_labels()) %>%
slice_head(n=10)
companies %>%
gt() %>%
cols_label(operator_number = "Company",
n = "Total Incidents") %>%
tab_header(title = "Total Reported Oil Loss Incidents Per Company") %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_title(groups = "title")) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_column_labels())
companies %>%
gt() %>%
cols_label(operator_number = "Company",
n = "Total Incidents") %>%
tab_header(title = "Total Reported Oil Loss Incidents Per Company") %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_title(groups = "title")) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_column_labels()) %>%
head(10)
companies %>%
head(10) %>%
gt() %>%
cols_label(operator_number = "Company",
n = "Total Incidents") %>%
tab_header(title = "Total Reported Oil Loss Incidents Per Company") %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_title(groups = "title")) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_column_labels())
companies %>%
head(10) %>%
gt() %>%
cols_label(operator_number = "Company",
n = "Total Incidents") %>%
tab_header(title = "Total Reported Oil Loss Incidents Per Company") %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_title(groups = "title")) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_column_labels()) %>%
tab_options(
table.width = px(800)  # Adjust the table width to 800 pixels
)
recovered_per_year %>%
gt() %>%
cols_label(master_year = "Year",
total_recovered = "Barrels Recovered") %>%
tab_header(title = "Total Barrels of Fracking Products Recovered Per Year") %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_title(groups = "title")) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_column_labels())
#Total number of incidents across all years
companies <- oil_loss %>%
group_by(operator_number) %>%
count() %>%
arrange(desc(n))
companies %>%
head(10) %>%
gt() %>%
cols_label(operator_number = "Company",
n = "Total Incidents") %>%
tab_header(title = "Total Reported Oil Loss Incidents Per Company") %>%
# tab_style(
#   style = list(
#     cell_text(weight = "bold")
#   ),
#   locations = cells_title(groups = "title")) %>%
# tab_style(
#   style = list(
#     cell_text(weight = "bold")
#   ),
#   locations = cells_column_labels()) %>%
tab_options(
table.width = px(800)  # Adjust the table width to 800 pixels
)
nice_table(companies, short = TRUE)
companies %>%
head(10) %>%
gt() %>%
cols_label(operator_number = "Company",
n = "Total Incidents") %>%
tab_header(title = "Total Reported Oil Loss Incidents Per Company") %>%
# tab_style(
#   style = list(
#     cell_text(weight = "bold")
#   ),
#   locations = cells_title(groups = "title")) %>%
# tab_style(
#   style = list(
#     cell_text(weight = "bold")
#   ),
#   locations = cells_column_labels()) %>%
tab_options(
table.width = px(800)  # Adjust the table width to 800 pixels
)
#Total number of incidents across all years
companies <- oil_loss %>%
group_by(operator_number) %>%
summarize(count = n()) %>%
arrange(desc(count))
#Total number of incidents across all years
companies <- oil_loss %>%
group_by(operator_number) %>%
count() %>%
arrange(desc(n))
#Total number of incidents across all years
companies <- oil_loss %>%
group_by(operator_number) %>%
summarize(count = n()) %>%
arrange(desc(count))
companies %>%
head(10) %>%
gt() %>%
cols_label(operator_number = "Company",
count = "Total Incidents") %>%
tab_header(title = "Total Reported Oil Loss Incidents Per Company") %>%
# tab_style(
#   style = list(
#     cell_text(weight = "bold")
#   ),
#   locations = cells_title(groups = "title")) %>%
# tab_style(
#   style = list(
#     cell_text(weight = "bold")
#   ),
#   locations = cells_column_labels()) %>%
tab_options(
table.width = px(800)  # Adjust the table width to 800 pixels
)
companies %>%
head(10) %>%
gt() %>%
cols_label(operator_number = "Company",
count = "Total Incidents") %>%
tab_header(title = "Total Reported Oil Loss Incidents Per Company") %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_title(groups = "title")) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_column_labels())
#Totals by year and company
companies_years <- oil_loss %>%
group_by(operator_number, master_year) %>%
count() %>%
arrange(desc(n))
head(companies_years)
#Totals by year and company
companies_years <- oil_loss %>%
group_by(operator_number, master_year) %>%
summarize(count = n()) %>%
arrange(desc(count))
View(companies_years)
View(companies_years)
companies_years %>%
head(10) %>%
gt() %>%
cols_label(operator_number = "Company",
master_year = "Year",
count = "Total Incidents") %>%
tab_header(title = "Total Reported Oil Loss Incidents Per Company and Year") %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_title(groups = "title")) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_column_labels())
companies_years %>%
head(10) %>%
gt() %>%
cols_label(operator_number = "Company",
master_year = "Year",
count = "Total Incidents") %>%
tab_header(title = "Total Reported Oil Loss Incidents Per Company and Year") %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_title(groups = "title")) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_column_labels()) %>%
tab_options(
table.width = px(800)  # Adjust the table width to 800 pixels
)
companies_years %>%
head(10) %>%
gt() %>%
cols_label(operator_number = "Company",
master_year = "Year",
count = "Total Incidents") %>%
tab_header(title = "Total Reported Oil Loss Incidents Per Company and Year") %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_title(groups = "title")) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_column_labels()) %>%
tab_options(
table.width = px(1000)  # Adjust the table width to 800 pixels
)
companies_years %>%
head(10) %>%
gt() %>%
cols_label(operator_number = "Company",
master_year = "Year",
count = "Total Incidents") %>%
tab_header(title = "Total Reported Oil Loss Incidents Per Company and Year") %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_title(groups = "title")) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_column_labels()) %>%
tab_options(
table.width = px(2000)  # Adjust the table width to 800 pixels
)
companies %>%
head(10) %>%
gt() %>%
cols_label(operator_number = "Company",
count = "Total Incidents") %>%
tab_header(title = "Total Reported Oil Loss Incidents Per Company") %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_title(groups = "title")) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_column_labels())
View(net_loss)
net_loss %>%
head(10) %>%
gt() %>%
cols_label(operator_number = "Company",
net_barrels = "Net Barrels") %>%
tab_header(title = "Net Barrels Lost Per Company") %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_title(groups = "title")) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_column_labels())
#Finding the average amount of barrels lost per company
oil_loss %>%
select(operator_number, net_loss) %>%
group_by(operator_number) %>%
summarize(avg_barrels = mean(net_loss, na.rm=TRUE)) %>%
arrange(desc(avg_barrels))
#Net loss per company
net_loss <- oil_loss %>%
select(operator_number, net_loss) %>%
group_by(operator_number) %>%
summarize(net_barrels = sum(net_loss, na.rm=TRUE)) %>%
arrange(desc(net_barrels))
net_loss %>%
head(10) %>%
gt() %>%
cols_label(operator_number = "Company",
net_barrels = "Net Barrels") %>%
tab_header(title = "Net Barrels Lost Per Company") %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_title(groups = "title")) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_column_labels())
#Finding the average amount of barrels lost per company
oil_loss %>%
select(operator_number, net_loss) %>%
group_by(operator_number) %>%
summarize(avg_barrels = mean(net_loss, na.rm=TRUE)) %>%
arrange(desc(avg_barrels))
#Finding the average amount of barrels lost per company
avg_loss <- oil_loss %>%
select(operator_number, net_loss) %>%
group_by(operator_number) %>%
summarize(avg_barrels = mean(net_loss, na.rm=TRUE)) %>%
arrange(desc(avg_barrels))
View(avg_loss)
avg_loss %>%
head(10) %>%
gt() %>%
cols_label(operator_number = "Company",
avg_barrels = "Average Barrels") %>%
tab_header(title = "Average Barrels Lost Per Incident Per Company") %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_title(groups = "title")) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_column_labels())
#Finding the average amount of barrels lost per company
avg_loss <- oil_loss %>%
select(operator_number, net_loss) %>%
group_by(operator_number) %>%
summarize(avg_barrels = round(mean(net_loss, na.rm=TRUE), 2)) %>%
arrange(desc(avg_barrels))
avg_loss %>%
head(10) %>%
gt() %>%
cols_label(operator_number = "Company",
avg_barrels = "Average Barrels") %>%
tab_header(title = "Average Barrels Lost Per Incident Per Company") %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_title(groups = "title")) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_column_labels())
net_loss %>%
head(10) %>%
gt() %>%
cols_label(operator_number = "Company",
net_barrels = "Net Barrels") %>%
tab_header(title = "Net Barrels Lost Per Company") %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_title(groups = "title")) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_column_labels())
avg_loss %>%
head(10) %>%
gt() %>%
cols_label(operator_number = "Company",
avg_barrels = "Average Barrels") %>%
tab_header(title = "Average Barrels Lost Per Incident Per Company") %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_title(groups = "title")) %>%
tab_style(
style = list(
cell_text(weight = "bold")
),
locations = cells_column_labels())
View(oil_loss)
