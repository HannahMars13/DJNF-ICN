filter(operator_number=="PIONEER NATURAL RES. USA, INC.") %>%
group_by(causeof_loss) %>%
summarize(total=n())
#interesting how there have been 567 recorded instances of oil loss due to equipment failure, yet only 5 of the 769 incidents had "installed new equipment" or "repaired existing equipment" in the remedy column.
counties <- oil_loss %>%
group_by(county) %>%
summarize(total_lost = sum(net_loss, na.rm=TRUE)) %>%
arrange(desc(total_lost))
#write_csv(counties, "texas_counties.csv")
oil_loss %>%
group_by(county) %>%
summarize(total_incidents = n()) %>%
arrange(desc(total_incidents))
#midland county
oil_loss %>%
filter(county=="MIDLAND") %>%
group_by(master_year) %>%
summarize(total_lost = sum(net_loss, na.rm=TRUE))
#crockett county
oil_loss %>%
filter(county=="CROCKETT") %>%
group_by(master_year) %>%
summarize(total_lost = sum(net_loss, na.rm=TRUE))
#crockett has the highest total lost, midland has the most incidents
#top 5 by oil volume rank: Pioneer Natural Resources, Diamondback, Endeavor Energy Resources, EOG Resources, XTO Energy
top_5 <- oil_loss %>%
filter(operator_number=="PIONEER NATURAL RES. USA, INC."|operator_number=="DIAMONDBACK E&P LLC"|operator_number=="ENDEAVOR ENERGY RESOURCES L.P."|operator_number=="EOG RESOURCdfv,';ES, INC."|operator_number=="XTO ENERGY INC.") %>%
group_by(operator_number, master_year) %>%
summarize(total_lost = sum(net_loss, na.rm=TRUE))
top_5 <- top_5 %>%
pivot_wider(names_from=operator_number, values_from=total_lost)
top_5 <- top_5 %>%
arrange(master_year)
#write_csv(top_5, "oil_loss_by_company.csv")
oil_loss %>%
filter(type_liquid=="Gas Well Liquid") %>%
summarize(sum = sum(net_loss, na.rm=TRUE))
#creating a new column to calculate what percent of the losses typically gets recovered
pct_recovered <- oil_loss %>%
select(master_year, operator_number, county, type_liquid, gross_loss, recovered, net_loss) %>%
mutate(pct_recovered = (recovered/gross_loss)*100)
#hypothesis: if the number of barrels is fewer, they are less likely to recover as much. (doesn't seem to actually be the case as a blanket statement)
pct_recovered %>%
filter(recovered==0) %>%
summarize(avg_loss = mean(gross_loss, na.rm=TRUE))
pct_recovered %>%
filter(pct_recovered==100) %>%
summarize(avg_loss = mean(gross_loss, na.rm=TRUE))
View(companies)
View(companies_years)
View(net_loss)
View(oil_loss)
View(top_5)
#top 5 by oil volume rank: Pioneer Natural Resources, Diamondback, Endeavor Energy Resources, EOG Resources, XTO Energy
top_5 <- oil_loss %>%
filter(operator_number=="PIONEER NATURAL RES. USA, INC."|operator_number=="DIAMONDBACK E&P LLC"|operator_number=="ENDEAVOR ENERGY RESOURCES L.P."|operator_number=="EOG RESOURCES, INC."|operator_number=="XTO ENERGY INC.") %>%
group_by(operator_number, master_year) %>%
summarize(total_lost = sum(net_loss, na.rm=TRUE))
top_5 <- top_5 %>%
pivot_wider(names_from=operator_number, values_from=total_lost)
top_5 <- top_5 %>%
arrange(master_year)
#write_csv(top_5, "oil_loss_by_company.csv")
test <- oil_loss %>%
filter(operator_number=="NFR ENERGY, LLC"|operator_number=="AMID SILVER DOLLAR PIPELINE LLC"|operator_number=="ENDEAVOR ENERGY RESOURCES L.P."|operator_number=="EPIC CONSOLIDATED OPS, LLC"|operator_number=="ANADARKO E&P ONSHORE LLC") %>%
group_by(operator_number, master_year) %>%
summarize(total_lost = sum(net_loss, na.rm=TRUE))
test <- test %>%
pivot_wider(names_from=operator_number, values_from=total_lost)
test <- test %>%
arrange(master_year)
View(test)
View(top_5)
View(loss_per_year)
View(counties)
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(janitor)
library(tidyverse)
oil_loss <- read_excel("combined_h8.xlsx") %>%
clean_names()
#totals across all years
companies <- oil_loss %>%
group_by(operator_number) %>%
count() %>%
arrange(desc(n))
head(companies)
#totals by year and company
companies_years <- oil_loss %>%
group_by(operator_number, master_year) %>%
count() %>%
arrange(desc(n))
head(companies_years)
sum(oil_loss$net_loss) * 42
#24,489,864 gallons of crude oil and gas well liquids have been lost since 2009!
#net loss per company
net_loss <- oil_loss %>%
select(operator_number, net_loss) %>%
group_by(operator_number) %>%
summarize(total_barrels = sum(net_loss, na.rm=TRUE)) %>%
arrange(desc(total_barrels))
#looking at average lost per company
oil_loss %>%
select(operator_number, net_loss) %>%
group_by(operator_number) %>%
summarize(avg_barrels = mean(net_loss, na.rm=TRUE)) %>%
arrange(desc(avg_barrels))
#net loss of crude oil by year
loss_per_year <- oil_loss %>%
group_by(master_year) %>%
summarize(total_loss = sum(net_loss, na.rm=TRUE))
#amount recovered
sum(oil_loss$recovered) #the number of recovered barrels is more than the net loss of barrels, but still not great
#recovered crude oil by year
recovered_per_year <- oil_loss %>%
group_by(master_year) %>%
summarize(total_recovered = sum(recovered, na.rm=TRUE))
#while net loss has been on the decline in recent years, in 2023, still only about 60% of lost oil was recovered (3453/5519), as can be seen here:
oil_loss %>%
filter(master_year==2023) %>%
summarize(total_lost = sum(net_loss, na.rm=TRUE))
oil_loss %>%
filter(master_year==2023) %>%
summarize(total_recovered = sum(recovered, na.rm=TRUE))
#net loss graph
ggplot(loss_per_year, aes(x=master_year, y=total_loss)) +
geom_line() +
labs(title = "Net loss of crude oil at an all time low since 2009")
#recovered barrels graph
ggplot(recovered_per_year, aes(x=master_year, y=total_recovered)) +
geom_line() +
labs(title = "Number of recovered barrels of crude oil on the decline")
oil_loss %>%
filter(operator_number=="PIONEER NATURAL RES. USA, INC.") %>%
group_by(remedy) %>%
summarize(total=n())
oil_loss %>%
filter(operator_number=="PIONEER NATURAL RES. USA, INC.") %>%
group_by(causeof_loss) %>%
summarize(total=n())
#interesting how there have been 567 recorded instances of oil loss due to equipment failure, yet only 5 of the 769 incidents had "installed new equipment" or "repaired existing equipment" in the remedy column.
counties <- oil_loss %>%
group_by(county) %>%
summarize(total_lost = sum(net_loss, na.rm=TRUE)) %>%
arrange(desc(total_lost))
#write_csv(counties, "texas_counties.csv")
oil_loss %>%
group_by(county) %>%
summarize(total_incidents = n()) %>%
arrange(desc(total_incidents))
#midland county
oil_loss %>%
filter(county=="MIDLAND") %>%
group_by(master_year) %>%
summarize(total_lost = sum(net_loss, na.rm=TRUE))
#crockett county
oil_loss %>%
filter(county=="CROCKETT") %>%
group_by(master_year) %>%
summarize(total_lost = sum(net_loss, na.rm=TRUE))
#crockett has the highest total lost, midland has the most incidents
#top 5 by oil volume rank: Pioneer Natural Resources, Diamondback, Endeavor Energy Resources, EOG Resources, XTO Energy
top_5_producers <- oil_loss %>%
filter(operator_number=="PIONEER NATURAL RES. USA, INC."|operator_number=="DIAMONDBACK E&P LLC"|operator_number=="ENDEAVOR ENERGY RESOURCES L.P."|operator_number=="EOG RESOURCES, INC."|operator_number=="XTO ENERGY INC.") %>%
group_by(operator_number, master_year) %>%
summarize(total_lost = sum(net_loss, na.rm=TRUE))
top_5_producers <- top_5_producers %>%
pivot_wider(names_from=operator_number, values_from=total_lost)
top_5_producers <- top_5_producers %>%
arrange(master_year)
#write_csv(top_5_producers, "oil_loss_by_company.csv")
oil_loss %>%
filter(type_liquid=="Gas Well Liquid") %>%
summarize(sum = sum(net_loss, na.rm=TRUE))
#creating a new column to calculate what percent of the losses typically gets recovered
pct_recovered <- oil_loss %>%
select(master_year, operator_number, county, type_liquid, gross_loss, recovered, net_loss) %>%
mutate(pct_recovered = (recovered/gross_loss)*100)
#hypothesis: if the number of barrels is fewer, they are less likely to recover as much. (doesn't seem to actually be the case as a blanket statement)
pct_recovered %>%
filter(recovered==0) %>%
summarize(avg_loss = mean(gross_loss, na.rm=TRUE))
pct_recovered %>%
filter(pct_recovered==100) %>%
summarize(avg_loss = mean(gross_loss, na.rm=TRUE))
test <- oil_loss %>%
filter(operator_number=="NFR ENERGY, LLC"|operator_number=="AMID SILVER DOLLAR PIPELINE LLC"|operator_number=="ENDEAVOR ENERGY RESOURCES L.P."|operator_number=="EPIC CONSOLIDATED OPS, LLC"|operator_number=="ANADARKO E&P ONSHORE LLC") %>%
group_by(operator_number, master_year) %>%
summarize(total_lost = sum(net_loss, na.rm=TRUE))
test <- test %>%
pivot_wider(names_from=operator_number, values_from=total_lost)
test <- test %>%
arrange(master_year)
View(net_loss)
top_5_losses <- oil_loss %>%
filter(operator_number=="NFR ENERGY, LLC"|operator_number=="AMID SILVER DOLLAR PIPELINE LLC"|operator_number=="ENDEAVOR ENERGY RESOURCES L.P."|operator_number=="EPIC CONSOLIDATED OPS, LLC"|operator_number=="ANADARKO E&P ONSHORE LLC") %>%
group_by(operator_number, master_year) %>%
summarize(total_lost = sum(net_loss, na.rm=TRUE))
top_5_losses <- top_5_losses %>%
pivot_wider(names_from=operator_number, values_from=total_lost)
top_5_losses <- top_5_losses %>%
arrange(master_year)
View(top_5_losses)
View(oil_loss)
sum(oil_loss$net_loss) * 42
#24,489,864 gallons of crude oil and gas well liquids have been lost since 2009!
#net loss per company
net_loss <- oil_loss %>%
select(operator_number, net_loss) %>%
group_by(operator_number) %>%
summarize(total_barrels = sum(net_loss, na.rm=TRUE)) %>%
arrange(desc(total_barrels))
#looking at average lost per company
oil_loss %>%
select(operator_number, net_loss) %>%
group_by(operator_number) %>%
summarize(avg_barrels = mean(net_loss, na.rm=TRUE)) %>%
arrange(desc(avg_barrels))
#while net loss has been on the decline in recent years, in 2023, still only about 60% of lost oil was recovered (3453/5519), as can be seen here:
oil_loss %>%
filter(master_year==2023) %>%
summarize(total_lost = sum(net_loss, na.rm=TRUE))
oil_loss %>%
filter(master_year==2023) %>%
summarize(total_recovered = sum(recovered, na.rm=TRUE))
oil_loss %>%
group_by(causeof_loss) %>%
summarize(total=n())
oil_loss %>%
group_by(causeof_loss) %>%
summarize(total=n()) %>%
arrange(desc(total))
oil_loss %>%
filter(causeof_loss="Equipment Failure" & remedy="Repaired Existing Equipment")
oil_loss %>%
filter(causeof_loss=="Equipment Failure" & remedy=="Repaired Existing Equipment")
oil_loss %>%
filter(causeof_loss=="Equipment Failure" & remedy=="Repaired Existing Equipment") %>%
count()
oil_loss %>%
group_by(causeof_loss) %>%
summarize(total=n()) %>%
arrange(desc(total))
oil_loss %>%
filter(causeof_loss=="Equipment Failure" & remedy=="Repaired Existing Equipment") %>%
count()
oil_loss %>%
group_by(causeof_loss) %>%
summarize(total=n()) %>%
arrange(desc(total))
oil_loss %>%
filter(causeof_loss=="Equipment Failure"|causeof_loss=="Corrosion - Rust") %>%
filter(remedy=="Repaired Existing Equipment") %>%
count()
oil_loss %>%
group_by(causeof_loss) %>%
summarize(total=n()) %>%
arrange(desc(total))
knitr::opts_chunk$set(echo = TRUE)
#net loss of crude oil by year
loss_per_year <- oil_loss %>%
group_by(master_year) %>%
summarize(total_loss = sum(net_loss, na.rm=TRUE))
library(readxl)
library(janitor)
library(tidyverse)
library(kableExtra)
oil_loss <- read_excel("combined_h8.xlsx") %>%
clean_names()
#net loss of crude oil by year
loss_per_year <- oil_loss %>%
group_by(master_year) %>%
summarize(total_loss = sum(net_loss, na.rm=TRUE))
View(loss_per_year)
oil_loss %>%
group_by(causeof_loss) %>%
summarize(total=n()) %>%
arrange(desc(total))
oil_loss %>%
group_by(master_year) %>%
summarize(total = sum(causeof_loss, na.rm=TRUE))
oil_loss %>%
group_by(master_year) %>%
summarize(total = n(causeof_loss))
oil_loss %>%
group_by(master_year, causeof_loss) %>%
summarize(total = n())
oil_loss %>%
filter(causeof_loss=="Equipment Failure"|causeof_loss="Corrosion - Rust")
oil_loss %>%
filter(causeof_loss=="Equipment Failure"|causeof_loss="Corrosion - Rust") %>%
oil_loss %>%
filter(causeof_loss=="Equipment Failure"|causeof_loss=="Corrosion - Rust") %>%
group_by(master_year, causeof_loss) %>%
summarize(total = n())
View(oil_loss)
equip_failures <- oil_loss %>%
select(master_year, causeof_loss) %>%
filter(causeof_loss=="Equipment Failure"|causeof_loss=="Corrosion - Rust")
View(equip_failures)
equip_failures <- oil_loss %>%
select(master_year, causeof_loss) %>%
filter(causeof_loss=="Equipment Failure"|causeof_loss=="Corrosion - Rust") %>%
group_by(master_year) %>%
summarize(total = n())
equip_failures <- oil_loss %>%
select(master_year, causeof_loss) %>%
filter(causeof_loss=="Equipment Failure"|causeof_loss=="Corrosion - Rust")
equip_failures <- oil_loss %>%
select(master_year, causeof_loss) %>%
filter(causeof_loss=="Equipment Failure"|causeof_loss=="Corrosion - Rust") %>%
group_by(master_year) %>%
summarize(total = n())
#amount recovered
sum(oil_loss$recovered) #the number of recovered barrels is more than the net loss of barrels, but still not great
#net loss of crude oil by year
loss_per_year <- oil_loss %>%
group_by(master_year) %>%
summarize(total_loss = sum(net_loss, na.rm=TRUE))
pct_recovered %>%
filter(recovered==0) %>%
summarize(avg_loss = mean(gross_loss, na.rm=TRUE))
#creating a new column to calculate what percent of the losses typically gets recovered
pct_recovered <- oil_loss %>%
select(master_year, operator_number, county, type_liquid, gross_loss, recovered, net_loss) %>%
mutate(pct_recovered = (recovered/gross_loss)*100)
head(pct_recovered)
#while net loss has been on the decline in recent years, in 2023, still only about 60% of lost oil was recovered (3453/5519), as can be seen here:
oil_loss %>%
filter(master_year==2023) %>%
summarize(total_lost = sum(net_loss, na.rm=TRUE))
oil_loss %>%
filter(master_year==2023) %>%
summarize(total_recovered = sum(recovered, na.rm=TRUE))
head(loss_per_year)
#While net loss has been on the decline in recent years, in 2023, still only about 60% of lost oil was recovered (3729/6130), as can be seen here:
oil_loss %>%
filter(master_year==2023) %>%
summarize(total_lost = sum(net_loss, na.rm=TRUE))
oil_loss %>%
filter(master_year==2023) %>%
summarize(total_recovered = sum(recovered, na.rm=TRUE))
#Net loss graph from 2009 to 2023
ggplot(loss_per_year, aes(x=master_year, y=total_loss)) +
geom_line() +
labs(title = "Net loss of crude oil at an all time low since 2009")
oil_loss %>%
group_by(causeof_loss) %>%
summarize(total=n()) %>%
arrange(desc(total))
equip_failures <- oil_loss %>%
select(master_year, causeof_loss) %>%
filter(causeof_loss=="Equipment Failure"|causeof_loss=="Corrosion - Rust") %>%
group_by(master_year) %>%
summarize(total = n())
oil_loss %>%
filter(causeof_loss=="Equipment Failure"|causeof_loss=="Corrosion - Rust") %>%
filter(remedy=="Repaired Existing Equipment") %>%
count()
equip_failures <- oil_loss %>%
select(master_year, causeof_loss) %>%
filter(causeof_loss=="Equipment Failure"|causeof_loss=="Corrosion - Rust") %>%
group_by(master_year) %>%
summarize(total = n())
oil_loss %>%
group_by(causeof_loss) %>%
summarize(total=n()) %>%
arrange(desc(total))
oil_loss %>%
filter(causeof_loss=="Equipment Failure"|causeof_loss=="Corrosion - Rust") %>%
filter(remedy=="Repaired Existing Equipment") %>%
count()
head(equip_failures)
#Net loss graph from 2009 to 2023
ggplot(loss_per_year, aes(x=master_year, y=total_loss)) +
geom_line() +
labs(title = "Net loss of crude oil at an all time low since 2009") +
theme_minimal()
#recovered barrels graph
ggplot(recovered_per_year, aes(x=master_year, y=total_recovered)) +
geom_line() +
labs(title = "Number of recovered barrels of crude oil on the decline") +
theme_minimal()
#recovered barrels graph
ggplot(recovered_per_year, aes(x=master_year, y=total_recovered)) +
geom_line() +
labs(title="Number of recovered barrels of crude oil on the decline", x="year", y="Total barrels recovered") +
theme_minimal()
#recovered barrels graph
ggplot(recovered_per_year, aes(x=master_year, y=total_recovered)) +
geom_line() +
labs(title="Number of recovered barrels of crude oil between 2009 and 2023", x="year", y="Total barrels recovered") +
theme_minimal()
#Net loss graph from 2009 to 2023
ggplot(loss_per_year, aes(x=master_year, y=total_loss)) +
geom_line() +
labs(title="Total net loss of fracking products between 2009 and 2023", x="year", y="Total barrels lost") +
theme_minimal()
#recovered barrels graph
ggplot(recovered_per_year, aes(x=master_year, y=total_recovered)) +
geom_line() +
labs(title="Number of recovered barrels of fracking products between 2009 and 2023", x="year", y="Total barrels recovered") +
theme_minimal()
#Total number of recovered barrels
sum(oil_loss$recovered)
#Creating a new column to calculate what percent of the losses typically gets recovered
pct_recovered <- oil_loss %>%
select(master_year, operator_number, county, type_liquid, gross_loss, recovered, net_loss) %>%
mutate(pct_recovered = (recovered/gross_loss)*100)
#Total number of incidents across all years
companies <- oil_loss %>%
group_by(operator_number) %>%
count() %>%
arrange(desc(n))
head(companies)
#Totals by year and company
companies_years <- oil_loss %>%
group_by(operator_number, master_year) %>%
count() %>%
arrange(desc(n))
head(companies_years)
#Finding the average amount of barrels lost per company
oil_loss %>%
select(operator_number, net_loss) %>%
group_by(operator_number) %>%
summarize(avg_barrels = mean(net_loss, na.rm=TRUE)) %>%
arrange(desc(avg_barrels))
#Net loss per company
net_loss <- oil_loss %>%
select(operator_number, net_loss) %>%
group_by(operator_number) %>%
summarize(total_barrels = sum(net_loss, na.rm=TRUE)) %>%
arrange(desc(total_barrels))
head(net_loss)
View(recovered_per_year)
#Net loss vs recovered barrels graph
loss_and_recovered <- merge(loss_per_year, recovered_per_year)
View(loss_per_year)
View(loss_and_recovered)
#Net loss vs recovered barrels graph
lost_and_recovered <- merge(loss_per_year, recovered_per_year)
ggplot(lost_and_recovered, aes(x=master_year, y=total_recovered)) +
geom_line() +
labs(title="Comparing the number of lost and recovered barrels of fracking products between 2009 and 2023", x="year", y="Total barrels recovered") +
theme_minimal()
ggplot(lost_and_recovered, aes(x = master_year)) +
geom_line(aes(y = loss_per_year, color = "Net Loss")) +
geom_line(aes(y = recovered_per_year, color = "Recovered")) +
labs(title="Comparing the number of lost and recovered barrels of fracking products between 2009 and 2023",
x="year", y="Total barrels", color = "Legend") +
theme_minimal()
#Net loss vs recovered barrels graph
lost_and_recovered <- merge(loss_per_year, recovered_per_year)
ggplot(lost_and_recovered, aes(x = master_year)) +
geom_line(aes(y = loss_per_year, color = "Net Loss")) +
geom_line(aes(y = recovered_per_year, color = "Recovered")) +
labs(title="Comparing the number of lost and recovered barrels of fracking products between 2009 and 2023",
x="year", y="Total barrels", color = "Legend") +
theme_minimal()
View(lost_and_recovered)
ggplot(lost_and_recovered, aes(x = master_year)) +
geom_line(aes(y = total_loss, color = "Net Loss")) +
geom_line(aes(y = total_recovered, color = "Recovered")) +
labs(title="Comparing the number of lost and recovered barrels of fracking products between 2009 and 2023",
x="year", y="Total barrels", color = "Legend") +
theme_minimal()
ggplot(lost_and_recovered, aes(x = master_year)) +
scale_color_manual(values = c("Net Loss" = "red", "Recovered" = "green"))
ggplot(lost_and_recovered, aes(x = master_year)) +
scale_color_manual(values = c("Net Loss" = "red", "Recovered" = "green")) +
geom_line(aes(y = total_loss, color = "Net Loss")) +
geom_line(aes(y = total_recovered, color = "Recovered")) +
labs(title="Comparing the number of lost and recovered barrels of fracking products between 2009 and 2023",
x="Year", y="Total barrels", color = "Legend") +
theme_minimal()
ggplot(lost_and_recovered, aes(x = master_year)) +
scale_color_manual(values = c("Net Loss" = "red", "Recovered" = "#028A0F")) +
geom_line(aes(y = total_loss, color = "Net Loss")) +
geom_line(aes(y = total_recovered, color = "Recovered")) +
labs(title="Comparing the number of lost and recovered barrels of fracking products between 2009 and 2023",
x="Year", y="Total barrels", color = "Legend") +
theme_minimal()
ggplot(lost_and_recovered, aes(x = master_year)) +
scale_color_manual(values = c("Net Loss" = "red", "Recovered" = "#028A0F")) +
geom_line(aes(y = total_loss, color = "Net Loss")) +
geom_line(aes(y = total_recovered, color = "Recovered")) +
labs(title="Comparing the number of lost and recovered barrels of fracking \nproducts between 2009 and 2023",
x="Year", y="Total barrels", color = "Legend") +
theme_minimal()
counties <- oil_loss %>%
group_by(county) %>%
summarize(total_lost = sum(net_loss, na.rm=TRUE)) %>%
arrange(desc(total_lost))
head(counties)
oil_loss %>%
group_by(county) %>%
summarize(total_incidents = n()) %>%
arrange(desc(total_incidents))
#Midland county
oil_loss %>%
filter(county=="MIDLAND") %>%
group_by(master_year) %>%
summarize(total_lost = sum(net_loss, na.rm=TRUE))
oil_loss %>%
group_by(causeof_loss) %>%
summarize(total=n()) %>%
arrange(desc(total))
oil_loss %>%
filter(causeof_loss=="Equipment Failure"|causeof_loss=="Corrosion - Rust") %>%
filter(remedy=="Repaired Existing Equipment") %>%
count()
head(top_5_losses)
