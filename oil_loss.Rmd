---
title: "Fracking Oil Loss"
author: "Hannah Marszalek"
date: "2024-06-03"
output: html_document
---

Hannah Marszalek 
June 6, 2024

Every year, oil companies in Texas lose thousands of barrels of liquid hydrocarbon (crude oil and gas well liquid) while fracking, amounting to a recorded total of 24,489,864 gallons lost since 2009 --- enough oil to fill 37 Olympic swimming pools. The companies are required to fill out a form known as an H-8 and submit it to the Railroad Commission of Texas each time such an event occurs (<https://www.rrc.texas.gov/media/fscnvxwt/h-8f.pdf>), but this information leaves room for plenty of questions regarding the effects and frequency of such events. The number of barrels lost has been on a steady decline since 2017 with 5,519 barrels lost in 2023, but this does not make these losses any less significant considering only 3,453 (about 60%) of these barrels were recovered.

If I were to continue forward with only focusing on Texas, the target audience would be the people who live there so they can become more aware of what is happening in their community since there may be long-lasting effects from these losses. If I were to broaden the focus to more states, the target audience would be anyone who lives near those fracking sites.

For interviews, I could try to speak to someone from one of the companies that are losing the most, an expert on the environmental effects of these oil spills, and someone who lives near these fracking locations to see how they feel about it.

I would like to gather information that will help me gain a better understanding of the remedial process following a spill and information that sheds light on the incidents that have occurred in the counties with the highest numbers of losses. For example, 26,199 barrels of crude oil were lost in Crockett County in 2019, and since this was the highest loss in that county out of all the years, it makes me wonder what happened that year that made it so much worse. Regarding the remedial process, many of the entries say there was "soil remediation" but they do not provide any detail as to what that actually entails. Furthermore, information on how much oil was produced these years would provide context to the significance of these losses.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readxl)
library(janitor)
library(tidyverse)

oil_loss <- read_excel("~/Desktop/GitHub/DJNF-ICN/combined_h8.xlsx") %>% 
  clean_names()
```

## counting the number of reported incidents per company

```{r}
#totals across all years
companies <- oil_loss %>% 
  group_by(operator_number) %>% 
  count() %>% 
  arrange(desc(n))

#totals by year and company
companies_years <- oil_loss %>% 
  group_by(operator_number, master_year) %>% 
  count() %>% 
  arrange(desc(n))
```

## finding total barrels that were unrecovered (net loss)

```{r}
sum(oil_loss$net_loss) * 42
#24,489,864 gallons of crude oil and gas well liquids have been lost since 2009!

#net loss of only crude oil per company
net_loss <- oil_loss %>% 
  filter(type_liquid=="Crude") %>% 
  select(operator_number, net_loss) %>% 
  group_by(operator_number) %>%
  summarize(total_barrels = sum(net_loss, na.rm=TRUE)) %>% 
  arrange(desc(total_barrels))

#looking at average lost per company
oil_loss %>%
  filter(type_liquid=="Crude") %>% 
  select(operator_number, net_loss) %>% 
  group_by(operator_number) %>%
  summarize(avg_barrels = mean(net_loss, na.rm=TRUE)) %>% 
  arrange(desc(avg_barrels))
```

## looking at a yearly view

```{r}
#net loss of crude oil by year
loss_per_year <- oil_loss %>% 
  filter(type_liquid=="Crude") %>%
  group_by(master_year) %>% 
  summarize(total_loss = sum(net_loss, na.rm=TRUE))

#amount recovered
sum(oil_loss$recovered) #the number of recovered barrels is more than the net loss of barrels, but still not great

#recovered crude oil by year
recovered_per_year <- oil_loss %>% 
  filter(type_liquid=="Crude") %>%
  group_by(master_year) %>% 
  summarize(total_recovered = sum(recovered, na.rm=TRUE))

#while net loss has been on the decline in recent years, in 2023, still only about 60% of lost oil was recovered (3453/5519), as can be seen here:
oil_loss %>% 
  filter(master_year==2023) %>% 
  filter(type_liquid=="Crude") %>% 
  summarize(total_lost = sum(net_loss, na.rm=TRUE))

oil_loss %>% 
  filter(master_year==2023) %>% 
  filter(type_liquid=="Crude") %>%
  summarize(total_recovered = sum(recovered, na.rm=TRUE))
```

## some quick graphs to visualize the yearly values

```{r}
#net loss graph
ggplot(loss_per_year, aes(x=master_year, y=total_loss)) +
  geom_line() +
  labs(title = "Net loss of crude oil at an all time low since 2009")
```

```{r}
#recovered barrels graph
ggplot(recovered_per_year, aes(x=master_year, y=total_recovered)) +
  geom_line() +
  labs(title = "Number of recovered barrels of crude oil on the decline")
```

## question: why does Pioneer Natural Resources have so many incidents?

```{r}
oil_loss %>% 
  filter(operator_number=="PIONEER NATURAL RES. USA, INC.") %>% 
  group_by(remedy) %>% 
  summarize(total=n())

oil_loss %>%
  filter(operator_number=="PIONEER NATURAL RES. USA, INC.") %>% 
  group_by(causeof_loss) %>% 
  summarize(total=n())

#interesting how there have been 567 recorded instances of oil loss due to equipment failure, yet only 5 of the 769 incidents had "installed new equipment" or "repaired existing equipment" in the remedy column.
```

## breakdown by county
Oil loss has been reported in 204 Texas counties.
View of all fracking locations in Texas: https://ft.maps.arcgis.com/apps/webappviewer/index.html?appid=f537aa46be49431fbb820c4e99e63474
Annual oil production by county: https://www.rrc.texas.gov/resource-center/data-visualization/oil-gas-data-visualization/oil-and-gas-production/

```{r}
counties <- oil_loss %>% 
  group_by(county) %>% 
  summarize(total_lost = sum(net_loss, na.rm=TRUE)) %>% 
  arrange(desc(total_lost))

#write_csv(counties, "texas_counties.csv")

oil_loss %>% 
  group_by(county) %>% 
  summarize(total_incidents = n()) %>%
  arrange(desc(total_incidents))

#midland county
oil_loss %>% 
  filter(county=="MIDLAND") %>% 
  filter(type_liquid=="Crude") %>%
  group_by(master_year) %>% 
  summarize(total_lost = sum(net_loss, na.rm=TRUE))

#crockett county
oil_loss %>% 
  filter(county=="CROCKETT") %>% 
  filter(type_liquid=="Crude") %>%
  group_by(master_year) %>% 
  summarize(total_lost = sum(net_loss, na.rm=TRUE))

#crockett has the highest total lost, midland has the most incidents
```

## looking at the top Texas oil companies
https://www.rrc.texas.gov/oil-and-gas/research-and-statistics/operator-information/texas-oil-and-gas-producers-by-rank-2023/

```{r}
#top 5 by oil volume rank: Pioneer Natural Resources, Diamondback, Endeavor Energy Resources, EOG Resources, XTO Energy
top_5 <- oil_loss %>% 
  filter(operator_number=="PIONEER NATURAL RES. USA, INC."|operator_number=="DIAMONDBACK E&P LLC"|operator_number=="ENDEAVOR ENERGY RESOURCES L.P."|operator_number=="EOG RESOURCdfv,';ES, INC."|operator_number=="XTO ENERGY INC.") %>%
  group_by(operator_number, master_year) %>% 
  summarize(total_lost = sum(net_loss, na.rm=TRUE))

top_5 <- top_5 %>% 
  pivot_wider(names_from=operator_number, values_from=total_lost)
 
top_5 <- top_5 %>% 
  arrange(master_year)

#write_csv(top_5, "oil_loss_by_company.csv")
```

## looking at gas well liquid

```{r}
oil_loss %>% 
  filter(type_liquid=="Gas Well Liquid") %>% 
  summarize(sum = sum(net_loss, na.rm=TRUE))
```

## closer look at the amount recovered

```{r}
#creating a new column to calculate what percent of the losses typically gets recovered
pct_recovered <- oil_loss %>% 
  select(master_year, operator_number, county, type_liquid, gross_loss, recovered, net_loss) %>% 
  mutate(pct_recovered = (recovered/gross_loss)*100)

#hypothesis: if the number of barrels is fewer, they are less likely to recover as much. (doesn't seem to actually be the case as a blanket statement)
pct_recovered %>% 
  filter(recovered==0) %>% 
  summarize(avg_loss = mean(gross_loss, na.rm=TRUE))

pct_recovered %>%
  filter(pct_recovered==100) %>%
  summarize(avg_loss = mean(gross_loss, na.rm=TRUE))
```
